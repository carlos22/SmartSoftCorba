#!/bin/sh
#--------------------------------------------------------------------------
# Code generated by the SmartSoft MDSD Toolchain Version 0.10.2
# The SmartSoft Toolchain has been developed by:
#  
# ZAFH Servicerobotic Ulm
# Christian Schlegel (schlegel@hs-ulm.de)
# University of Applied Sciences
# Prittwitzstr. 10
# 89075 Ulm (Germany)
#
# Information about the SmartSoft MDSD Toolchain is available at:
# smart-robotics.sourceforge.net
# 
# Please do not modify this file. It will be re-generated
# running the code generator.
#--------------------------------------------------------------------------

	    
#######
## case
case "$1" in
	    
	    
#########################################################################################
## start
start)
    	
### protected region for startup code			
# PROTECTED REGION ID(CustomUserStartupCode) ENABLED START
# put your custom startup code here

xterm -e "cd $SMART_ROOT/src/components/SmartPlayerStageSimulator/src/player_stage; robot-player smart_hospital_small.cfg" &
sleep 4

# PROTECTED REGION END    	
	    
## start naming service
if [ `ps -Al | grep -c Naming_Service` -eq 1 ]
then 
	echo "shuttting down CORBA Naming Service ..."
	killall Naming_Service
	echo "starting CORBA Naming Service ..."
	$TAO_ROOT/orbsvcs/Naming_Service/Naming_Service -m 0 -ORBEndpoint iiop://0.0.0.0:9999 &
	echo "CORBA Naming Service is running!"
else 
	echo "starting CORBA Naming Service ..."
	$TAO_ROOT/orbsvcs/Naming_Service/Naming_Service -m 0 -ORBEndpoint iiop://0.0.0.0:9999 &
	echo "CORBA Naming Service is running!"
fi




## start components
echo "starting components..."
xterm -e $SMART_ROOT/bin/smartLaserObstacleAvoid -filename=SmartLaserObstacleAvoid.ini -ORBInitRef NameService=corbaloc:iiop:0.0.0.0:9999/NameService &
xterm -e $SMART_ROOT/bin/smartPlayerStageSimulator -filename=SmartPlayerStageSimulator.ini -ORBInitRef NameService=corbaloc:iiop:0.0.0.0:9999/NameService &

;; ## start
		
		
#########################################################################################
## stop
stop)

echo "kill all components..."
killall smartLaserObstacleAvoid
killall smartPlayerStageSimulator
## TODO: ssh <username>@<target> 'killall xxx'

if [ `ps -Al | grep -c Naming_Service` -eq 1 ]
then 
  echo "shuttting down CORBA Naming Service ..."
  killall Naming_Service
  echo "CORBA Naming Service is down!"
else 
  echo "CORBA Naming Service is not running!"
fi




### protected region for shutdown code			
# PROTECTED REGION ID(CustomUserShutdownCode) ENABLED START
# put your custom shutdown code here

killall robot-player

# PROTECTED REGION END    
;; ## stop
		
		
		
#########################################################################################
## default
*)
echo "Usage: $0 {start|stop}"
exit 1
;; ## default

esac

